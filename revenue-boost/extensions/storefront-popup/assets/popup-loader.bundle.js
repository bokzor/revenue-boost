"use strict";(()=>{var G=Object.defineProperty;var st=Object.getOwnPropertyDescriptor;var at=Object.getOwnPropertyNames;var lt=Object.prototype.hasOwnProperty;var ct=(t,e,n)=>e in t?G(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var Se=(t,e)=>()=>(t&&(e=t(t=0)),e);var Ee=(t,e)=>{for(var n in e)G(t,n,{get:e[n],enumerable:!0})},ut=(t,e,n,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of at(e))!lt.call(t,o)&&o!==n&&G(t,o,{get:()=>e[o],enumerable:!(i=st(e,o))||i.enumerable});return t};var Pe=t=>ut(G({},"__esModule",{value:!0}),t);var u=(t,e,n)=>ct(t,typeof e!="symbol"?e+"":e,n);var ze={};Ee(ze,{Component:()=>O,Fragment:()=>W,cloneElement:()=>mt,createContext:()=>vt,createElement:()=>R,createRef:()=>dt,h:()=>R,hydrate:()=>qe,isValidElement:()=>He,options:()=>f,render:()=>q,toChildArray:()=>Be});function S(t,e){for(var n in e)t[n]=e[n];return t}function pe(t){t&&t.parentNode&&t.parentNode.removeChild(t)}function R(t,e,n){var i,o,r,a={};for(r in e)r=="key"?i=e[r]:r=="ref"?o=e[r]:a[r]=e[r];if(arguments.length>2&&(a.children=arguments.length>3?$.call(arguments,2):n),typeof t=="function"&&t.defaultProps!=null)for(r in t.defaultProps)a[r]===void 0&&(a[r]=t.defaultProps[r]);return F(t,a,i,o,null)}function F(t,e,n,i,o){var r={type:t,props:e,key:n,ref:i,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:o??++xe,__i:-1,__u:0};return o==null&&f.vnode!=null&&f.vnode(r),r}function dt(){return{current:null}}function W(t){return t.children}function O(t,e){this.props=t,this.context=e}function M(t,e){if(e==null)return t.__?M(t.__,t.__i+1):null;for(var n;e<t.__k.length;e++)if((n=t.__k[e])!=null&&n.__e!=null)return n.__e;return typeof t.type=="function"?M(t):null}function Ue(t){var e,n;if((t=t.__)!=null&&t.__c!=null){for(t.__e=t.__c.base=null,e=0;e<t.__k.length;e++)if((n=t.__k[e])!=null&&n.__e!=null){t.__e=t.__c.base=n.__e;break}return Ue(t)}}function ue(t){(!t.__d&&(t.__d=!0)&&I.push(t)&&!Q.__r++||ke!=f.debounceRendering)&&((ke=f.debounceRendering)||Me)(Q)}function Q(){for(var t,e,n,i,o,r,a,c=1;I.length;)I.length>c&&I.sort(Re),t=I.shift(),c=I.length,t.__d&&(n=void 0,i=void 0,o=(i=(e=t).__v).__e,r=[],a=[],e.__P&&((n=S({},i)).__v=i.__v+1,f.vnode&&f.vnode(n),he(e.__P,n,i,e.__n,e.__P.namespaceURI,32&i.__u?[o]:null,r,o??M(i),!!(32&i.__u),a),n.__v=i.__v,n.__.__k[n.__i]=n,$e(r,n,a),i.__e=i.__=null,n.__e!=o&&Ue(n)));Q.__r=0}function Fe(t,e,n,i,o,r,a,c,d,l,p){var s,h,_,b,C,w,m,v=i&&i.__k||Ne,P=e.length;for(d=pt(n,e,v,d,P),s=0;s<P;s++)(_=n.__k[s])!=null&&(h=_.__i==-1?B:v[_.__i]||B,_.__i=s,w=he(t,_,h,o,r,a,c,d,l,p),b=_.__e,_.ref&&h.ref!=_.ref&&(h.ref&&fe(h.ref,null,_),p.push(_.ref,_.__c||b,_)),C==null&&b!=null&&(C=b),(m=!!(4&_.__u))||h.__k===_.__k?d=Oe(_,d,t,m):typeof _.type=="function"&&w!==void 0?d=w:b&&(d=b.nextSibling),_.__u&=-7);return n.__e=C,d}function pt(t,e,n,i,o){var r,a,c,d,l,p=n.length,s=p,h=0;for(t.__k=new Array(o),r=0;r<o;r++)(a=e[r])!=null&&typeof a!="boolean"&&typeof a!="function"?(d=r+h,(a=t.__k[r]=typeof a=="string"||typeof a=="number"||typeof a=="bigint"||a.constructor==String?F(null,a,null,null,null):V(a)?F(W,{children:a},null,null,null):a.constructor==null&&a.__b>0?F(a.type,a.props,a.key,a.ref?a.ref:null,a.__v):a).__=t,a.__b=t.__b+1,c=null,(l=a.__i=ht(a,n,d,s))!=-1&&(s--,(c=n[l])&&(c.__u|=2)),c==null||c.__v==null?(l==-1&&(o>p?h--:o<p&&h++),typeof a.type!="function"&&(a.__u|=4)):l!=d&&(l==d-1?h--:l==d+1?h++:(l>d?h--:h++,a.__u|=4))):t.__k[r]=null;if(s)for(r=0;r<p;r++)(c=n[r])!=null&&(2&c.__u)==0&&(c.__e==i&&(i=M(c)),We(c,c));return i}function Oe(t,e,n,i){var o,r;if(typeof t.type=="function"){for(o=t.__k,r=0;o&&r<o.length;r++)o[r]&&(o[r].__=t,e=Oe(o[r],e,n,i));return e}t.__e!=e&&(i&&(e&&t.type&&!e.parentNode&&(e=M(t)),n.insertBefore(t.__e,e||null)),e=t.__e);do e=e&&e.nextSibling;while(e!=null&&e.nodeType==8);return e}function Be(t,e){return e=e||[],t==null||typeof t=="boolean"||(V(t)?t.some(function(n){Be(n,e)}):e.push(t)),e}function ht(t,e,n,i){var o,r,a,c=t.key,d=t.type,l=e[n],p=l!=null&&(2&l.__u)==0;if(l===null&&t.key==null||p&&c==l.key&&d==l.type)return n;if(i>(p?1:0)){for(o=n-1,r=n+1;o>=0||r<e.length;)if((l=e[a=o>=0?o--:r++])!=null&&(2&l.__u)==0&&c==l.key&&d==l.type)return a}return-1}function Ie(t,e,n){e[0]=="-"?t.setProperty(e,n??""):t[e]=n==null?"":typeof n!="number"||_t.test(e)?n:n+"px"}function K(t,e,n,i,o){var r,a;e:if(e=="style")if(typeof n=="string")t.style.cssText=n;else{if(typeof i=="string"&&(t.style.cssText=i=""),i)for(e in i)n&&e in n||Ie(t.style,e,"");if(n)for(e in n)i&&n[e]==i[e]||Ie(t.style,e,n[e])}else if(e[0]=="o"&&e[1]=="n")r=e!=(e=e.replace(Ae,"$1")),a=e.toLowerCase(),e=a in t||e=="onFocusOut"||e=="onFocusIn"?a.slice(2):e.slice(2),t.l||(t.l={}),t.l[e+r]=n,n?i?n.u=i.u:(n.u=de,t.addEventListener(e,r?ce:le,r)):t.removeEventListener(e,r?ce:le,r);else{if(o=="http://www.w3.org/2000/svg")e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!="width"&&e!="height"&&e!="href"&&e!="list"&&e!="form"&&e!="tabIndex"&&e!="download"&&e!="rowSpan"&&e!="colSpan"&&e!="role"&&e!="popover"&&e in t)try{t[e]=n??"";break e}catch{}typeof n=="function"||(n==null||n===!1&&e[4]!="-"?t.removeAttribute(e):t.setAttribute(e,e=="popover"&&n==1?"":n))}}function De(t){return function(e){if(this.l){var n=this.l[e.type+t];if(e.t==null)e.t=de++;else if(e.t<n.u)return;return n(f.event?f.event(e):e)}}}function he(t,e,n,i,o,r,a,c,d,l){var p,s,h,_,b,C,w,m,v,P,k,z,N,Te,j,U,re,T=e.type;if(e.constructor!=null)return null;128&n.__u&&(d=!!(32&n.__u),r=[c=e.__e=n.__e]),(p=f.__b)&&p(e);e:if(typeof T=="function")try{if(m=e.props,v="prototype"in T&&T.prototype.render,P=(p=T.contextType)&&i[p.__c],k=p?P?P.props.value:p.__:i,n.__c?w=(s=e.__c=n.__c).__=s.__E:(v?e.__c=s=new T(m,k):(e.__c=s=new O(m,k),s.constructor=T,s.render=gt),P&&P.sub(s),s.props=m,s.state||(s.state={}),s.context=k,s.__n=i,h=s.__d=!0,s.__h=[],s._sb=[]),v&&s.__s==null&&(s.__s=s.state),v&&T.getDerivedStateFromProps!=null&&(s.__s==s.state&&(s.__s=S({},s.__s)),S(s.__s,T.getDerivedStateFromProps(m,s.__s))),_=s.props,b=s.state,s.__v=e,h)v&&T.getDerivedStateFromProps==null&&s.componentWillMount!=null&&s.componentWillMount(),v&&s.componentDidMount!=null&&s.__h.push(s.componentDidMount);else{if(v&&T.getDerivedStateFromProps==null&&m!==_&&s.componentWillReceiveProps!=null&&s.componentWillReceiveProps(m,k),!s.__e&&s.shouldComponentUpdate!=null&&s.shouldComponentUpdate(m,s.__s,k)===!1||e.__v==n.__v){for(e.__v!=n.__v&&(s.props=m,s.state=s.__s,s.__d=!1),e.__e=n.__e,e.__k=n.__k,e.__k.some(function(x){x&&(x.__=e)}),z=0;z<s._sb.length;z++)s.__h.push(s._sb[z]);s._sb=[],s.__h.length&&a.push(s);break e}s.componentWillUpdate!=null&&s.componentWillUpdate(m,s.__s,k),v&&s.componentDidUpdate!=null&&s.__h.push(function(){s.componentDidUpdate(_,b,C)})}if(s.context=k,s.props=m,s.__P=t,s.__e=!1,N=f.__r,Te=0,v){for(s.state=s.__s,s.__d=!1,N&&N(e),p=s.render(s.props,s.state,s.context),j=0;j<s._sb.length;j++)s.__h.push(s._sb[j]);s._sb=[]}else do s.__d=!1,N&&N(e),p=s.render(s.props,s.state,s.context),s.state=s.__s;while(s.__d&&++Te<25);s.state=s.__s,s.getChildContext!=null&&(i=S(S({},i),s.getChildContext())),v&&!h&&s.getSnapshotBeforeUpdate!=null&&(C=s.getSnapshotBeforeUpdate(_,b)),U=p,p!=null&&p.type===W&&p.key==null&&(U=Ve(p.props.children)),c=Fe(t,V(U)?U:[U],e,n,i,o,r,a,c,d,l),s.base=e.__e,e.__u&=-161,s.__h.length&&a.push(s),w&&(s.__E=s.__=null)}catch(x){if(e.__v=null,d||r!=null)if(x.then){for(e.__u|=d?160:128;c&&c.nodeType==8&&c.nextSibling;)c=c.nextSibling;r[r.indexOf(c)]=null,e.__e=c}else{for(re=r.length;re--;)pe(r[re]);_e(e)}else e.__e=n.__e,e.__k=n.__k,x.then||_e(e);f.__e(x,e,n)}else r==null&&e.__v==n.__v?(e.__k=n.__k,e.__e=n.__e):c=e.__e=ft(n.__e,e,n,i,o,r,a,d,l);return(p=f.diffed)&&p(e),128&e.__u?void 0:c}function _e(t){t&&t.__c&&(t.__c.__e=!0),t&&t.__k&&t.__k.forEach(_e)}function $e(t,e,n){for(var i=0;i<n.length;i++)fe(n[i],n[++i],n[++i]);f.__c&&f.__c(e,t),t.some(function(o){try{t=o.__h,o.__h=[],t.some(function(r){r.call(o)})}catch(r){f.__e(r,o.__v)}})}function Ve(t){return typeof t!="object"||t==null||t.__b&&t.__b>0?t:V(t)?t.map(Ve):S({},t)}function ft(t,e,n,i,o,r,a,c,d){var l,p,s,h,_,b,C,w=n.props,m=e.props,v=e.type;if(v=="svg"?o="http://www.w3.org/2000/svg":v=="math"?o="http://www.w3.org/1998/Math/MathML":o||(o="http://www.w3.org/1999/xhtml"),r!=null){for(l=0;l<r.length;l++)if((_=r[l])&&"setAttribute"in _==!!v&&(v?_.localName==v:_.nodeType==3)){t=_,r[l]=null;break}}if(t==null){if(v==null)return document.createTextNode(m);t=document.createElementNS(o,v,m.is&&m),c&&(f.__m&&f.__m(e,r),c=!1),r=null}if(v==null)w===m||c&&t.data==m||(t.data=m);else{if(r=r&&$.call(t.childNodes),w=n.props||B,!c&&r!=null)for(w={},l=0;l<t.attributes.length;l++)w[(_=t.attributes[l]).name]=_.value;for(l in w)if(_=w[l],l!="children"){if(l=="dangerouslySetInnerHTML")s=_;else if(!(l in m)){if(l=="value"&&"defaultValue"in m||l=="checked"&&"defaultChecked"in m)continue;K(t,l,null,_,o)}}for(l in m)_=m[l],l=="children"?h=_:l=="dangerouslySetInnerHTML"?p=_:l=="value"?b=_:l=="checked"?C=_:c&&typeof _!="function"||w[l]===_||K(t,l,_,w[l],o);if(p)c||s&&(p.__html==s.__html||p.__html==t.innerHTML)||(t.innerHTML=p.__html),e.__k=[];else if(s&&(t.innerHTML=""),Fe(e.type=="template"?t.content:t,V(h)?h:[h],e,n,i,v=="foreignObject"?"http://www.w3.org/1999/xhtml":o,r,a,r?r[0]:n.__k&&M(n,0),c,d),r!=null)for(l=r.length;l--;)pe(r[l]);c||(l="value",v=="progress"&&b==null?t.removeAttribute("value"):b!=null&&(b!==t[l]||v=="progress"&&!b||v=="option"&&b!=w[l])&&K(t,l,b,w[l],o),l="checked",C!=null&&C!=t[l]&&K(t,l,C,w[l],o))}return t}function fe(t,e,n){try{if(typeof t=="function"){var i=typeof t.__u=="function";i&&t.__u(),i&&e==null||(t.__u=t(e))}else t.current=e}catch(o){f.__e(o,n)}}function We(t,e,n){var i,o;if(f.unmount&&f.unmount(t),(i=t.ref)&&(i.current&&i.current!=t.__e||fe(i,null,e)),(i=t.__c)!=null){if(i.componentWillUnmount)try{i.componentWillUnmount()}catch(r){f.__e(r,e)}i.base=i.__P=null}if(i=t.__k)for(o=0;o<i.length;o++)i[o]&&We(i[o],e,n||typeof t.type!="function");n||pe(t.__e),t.__c=t.__=t.__e=void 0}function gt(t,e,n){return this.constructor(t,n)}function q(t,e,n){var i,o,r,a;e==document&&(e=document.documentElement),f.__&&f.__(t,e),o=(i=typeof n=="function")?null:n&&n.__k||e.__k,r=[],a=[],he(e,t=(!i&&n||e).__k=R(W,null,[t]),o||B,B,e.namespaceURI,!i&&n?[n]:o?null:e.firstChild?$.call(e.childNodes):null,r,!i&&n?n:o?o.__e:e.firstChild,i,a),$e(r,t,a)}function qe(t,e){q(t,e,qe)}function mt(t,e,n){var i,o,r,a,c=S({},t.props);for(r in t.type&&t.type.defaultProps&&(a=t.type.defaultProps),e)r=="key"?i=e[r]:r=="ref"?o=e[r]:c[r]=e[r]===void 0&&a!=null?a[r]:e[r];return arguments.length>2&&(c.children=arguments.length>3?$.call(arguments,2):n),F(t.type,c,i||t.key,o||t.ref,null)}function vt(t){function e(n){var i,o;return this.getChildContext||(i=new Set,(o={})[e.__c]=this,this.getChildContext=function(){return o},this.componentWillUnmount=function(){i=null},this.shouldComponentUpdate=function(r){this.props.value!=r.value&&i.forEach(function(a){a.__e=!0,ue(a)})},this.sub=function(r){i.add(r);var a=r.componentWillUnmount;r.componentWillUnmount=function(){i&&i.delete(r),a&&a.call(r)}}),n.children}return e.__c="__cC"+Le++,e.__=t,e.Provider=e.__l=(e.Consumer=function(n,i){return n.children(i)}).contextType=e,e}var $,f,xe,He,I,ke,Me,Re,Ae,de,le,ce,Le,B,Ne,_t,V,X=Se(()=>{B={},Ne=[],_t=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,V=Array.isArray;$=Ne.slice,f={__e:function(t,e,n,i){for(var o,r,a;e=e.__;)if((o=e.__c)&&!o.__)try{if((r=o.constructor)&&r.getDerivedStateFromError!=null&&(o.setState(r.getDerivedStateFromError(t)),a=o.__d),o.componentDidCatch!=null&&(o.componentDidCatch(t,i||{}),a=o.__d),a)return o.__E=o}catch(c){t=c}throw t}},xe=0,He=function(t){return t!=null&&t.constructor==null},O.prototype.setState=function(t,e){var n;n=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=S({},this.state),typeof t=="function"&&(t=t(S({},n),this.props)),t&&S(n,t),t!=null&&this.__v&&(e&&this._sb.push(e),ue(this))},O.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),ue(this))},O.prototype.render=W,I=[],Me=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Re=function(t,e){return t.__v.__b-e.__v.__b},Q.__r=0,Ae=/(PointerCapture)$|Capture$/i,de=0,le=De(!1),ce=De(!0),Le=0});var rt={};Ee(rt,{useCallback:()=>wt,useContext:()=>Ct,useDebugValue:()=>Tt,useEffect:()=>ve,useErrorBoundary:()=>St,useId:()=>Et,useImperativeHandle:()=>bt,useLayoutEffect:()=>nt,useMemo:()=>ye,useReducer:()=>tt,useRef:()=>yt,useState:()=>L});function D(t,e){y.__h&&y.__h(g,t,A||e),A=0;var n=g.__H||(g.__H={__:[],__h:[]});return t>=n.__.length&&n.__.push({}),n.__[t]}function L(t){return A=1,tt(it,t)}function tt(t,e,n){var i=D(E++,2);if(i.t=t,!i.__c&&(i.__=[n?n(e):it(void 0,e),function(c){var d=i.__N?i.__N[0]:i.__[0],l=i.t(d,c);d!==l&&(i.__N=[l,i.__[1]],i.__c.setState({}))}],i.__c=g,!g.__f)){var o=function(c,d,l){if(!i.__c.__H)return!0;var p=i.__c.__H.__.filter(function(h){return!!h.__c});if(p.every(function(h){return!h.__N}))return!r||r.call(this,c,d,l);var s=i.__c.props!==c;return p.forEach(function(h){if(h.__N){var _=h.__[0];h.__=h.__N,h.__N=void 0,_!==h.__[0]&&(s=!0)}}),r&&r.call(this,c,d,l)||s};g.__f=!0;var r=g.shouldComponentUpdate,a=g.componentWillUpdate;g.componentWillUpdate=function(c,d,l){if(this.__e){var p=r;r=void 0,o(c,d,l),r=p}a&&a.call(this,c,d,l)},g.shouldComponentUpdate=o}return i.__N||i.__}function ve(t,e){var n=D(E++,3);!y.__s&&be(n.__H,e)&&(n.__=t,n.u=e,g.__H.__h.push(n))}function nt(t,e){var n=D(E++,4);!y.__s&&be(n.__H,e)&&(n.__=t,n.u=e,g.__h.push(n))}function yt(t){return A=5,ye(function(){return{current:t}},[])}function bt(t,e,n){A=6,nt(function(){if(typeof t=="function"){var i=t(e());return function(){t(null),i&&typeof i=="function"&&i()}}if(t)return t.current=e(),function(){return t.current=null}},n==null?n:n.concat(t))}function ye(t,e){var n=D(E++,7);return be(n.__H,e)&&(n.__=t(),n.__H=e,n.__h=t),n.__}function wt(t,e){return A=8,ye(function(){return t},e)}function Ct(t){var e=g.context[t.__c],n=D(E++,9);return n.c=t,e?(n.__==null&&(n.__=!0,e.sub(g)),e.props.value):t.__}function Tt(t,e){y.useDebugValue&&y.useDebugValue(e?e(t):t)}function St(t){var e=D(E++,10),n=L();return e.__=t,g.componentDidCatch||(g.componentDidCatch=function(i,o){e.__&&e.__(i,o),n[1](i)}),[n[0],function(){n[1](void 0)}]}function Et(){var t=D(E++,11);if(!t.__){for(var e=g.__v;e!==null&&!e.__m&&e.__!==null;)e=e.__;var n=e.__m||(e.__m=[0,0]);t.__="P"+n[0]+"-"+n[1]++}return t.__}function Pt(){for(var t;t=et.shift();)if(t.__P&&t.__H)try{t.__H.__h.forEach(Z),t.__H.__h.forEach(me),t.__H.__h=[]}catch(e){t.__H.__h=[],y.__e(e,t.__v)}}function kt(t){var e,n=function(){clearTimeout(i),Ze&&cancelAnimationFrame(e),setTimeout(t)},i=setTimeout(n,35);Ze&&(e=requestAnimationFrame(n))}function Z(t){var e=g,n=t.__c;typeof n=="function"&&(t.__c=void 0,n()),g=e}function me(t){var e=g;t.__c=t.__(),g=e}function be(t,e){return!t||t.length!==e.length||e.some(function(n,i){return n!==t[i]})}function it(t,e){return typeof e=="function"?e(t):e}var E,g,ge,je,A,et,y,Ge,Ye,Je,Ke,Qe,Xe,Ze,we=Se(()=>{X();A=0,et=[],y=f,Ge=y.__b,Ye=y.__r,Je=y.diffed,Ke=y.__c,Qe=y.unmount,Xe=y.__;y.__b=function(t){g=null,Ge&&Ge(t)},y.__=function(t,e){t&&e.__k&&e.__k.__m&&(t.__m=e.__k.__m),Xe&&Xe(t,e)},y.__r=function(t){Ye&&Ye(t),E=0;var e=(g=t.__c).__H;e&&(ge===g?(e.__h=[],g.__h=[],e.__.forEach(function(n){n.__N&&(n.__=n.__N),n.u=n.__N=void 0})):(e.__h.forEach(Z),e.__h.forEach(me),e.__h=[],E=0)),ge=g},y.diffed=function(t){Je&&Je(t);var e=t.__c;e&&e.__H&&(e.__H.__h.length&&(et.push(e)!==1&&je===y.requestAnimationFrame||((je=y.requestAnimationFrame)||kt)(Pt)),e.__H.__.forEach(function(n){n.u&&(n.__H=n.u),n.u=void 0})),ge=g=null},y.__c=function(t,e){e.some(function(n){try{n.__h.forEach(Z),n.__h=n.__h.filter(function(i){return!i.__||me(i)})}catch(i){e.some(function(o){o.__h&&(o.__h=[])}),e=[],y.__e(i,n.__v)}}),Ke&&Ke(t,e)},y.unmount=function(t){Qe&&Qe(t);var e,n=t.__c;n&&n.__H&&(n.__H.__.forEach(function(i){try{Z(i)}catch(o){e=o}}),n.__H=void 0,e&&y.__e(e,n.__v))};Ze=typeof requestAnimationFrame=="function"});var Y=class{constructor(e){u(this,"config");this.config=e}log(...e){this.config.debug&&console.log("[Revenue Boost API]",...e)}getApiUrl(e){let n=this.config.apiUrl||"",i=e.startsWith("/")?e:`/${e}`;return n?`${n}${i}`:`/apps/revenue-boost${i}`}async fetchActiveCampaigns(e){let n=this.buildStorefrontContext(e),i=new URLSearchParams({shop:this.config.shopDomain,...n}),o=`${this.getApiUrl("/api/campaigns/active")}?${i.toString()}`;this.log("Fetching campaigns from:",o),this.log("Context:",n);try{let r=await fetch(o,{method:"GET",headers:{"Content-Type":"application/json"}});if(!r.ok)throw new Error(`HTTP ${r.status}: ${r.statusText}`);let a=await r.json();return this.log("Campaigns received:",a),a}catch(r){throw console.error("[Revenue Boost API] Failed to fetch campaigns:",r),r}}buildStorefrontContext(e){let n={sessionId:e,pageUrl:window.location.pathname,pageType:this.detectPageType(),deviceType:this.detectDeviceType()};if(typeof window.Shopify<"u"){let i=window.Shopify;i.cart&&(n.cartValue=String(i.cart.total_price/100),n.cartItemCount=String(i.cart.item_count))}return n}detectPageType(){let e=window.location.pathname;return e==="/"||e===""?"home":e.includes("/products/")?"product":e.includes("/collections/")?"collection":e.includes("/cart")?"cart":e.includes("/checkout")?"checkout":"other"}detectDeviceType(){let e=navigator.userAgent.toLowerCase();return/android|webos|iphone|ipod|blackberry|iemobile|opera mini/i.test(e)?"mobile":/ipad|android(?!.*mobile)/i.test(e)?"tablet":"desktop"}async recordFrequency(e,n){let i=this.getApiUrl("/api/analytics/frequency");try{await fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sessionId:e,campaignId:n,timestamp:Date.now()})})}catch(o){console.error("[Revenue Boost API] Failed to record frequency:",o)}}async trackEvent(e){let n=this.getApiUrl("/api/analytics/track");try{await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}catch(i){console.error("[Revenue Boost API] Failed to track event:",i)}}};var oe="revenue_boost_session",se="revenue_boost_shown",ae=class{constructor(){u(this,"sessionId");u(this,"shownCampaigns");this.sessionId=this.initSessionId(),this.shownCampaigns=this.loadShownCampaigns(),this.incrementVisitCount()}initSessionId(){let e=sessionStorage.getItem(oe);return e||(e=`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,sessionStorage.setItem(oe,e)),e}loadShownCampaigns(){let e=sessionStorage.getItem(se);if(e)try{return new Set(JSON.parse(e))}catch{return new Set}return new Set}saveShownCampaigns(){sessionStorage.setItem(se,JSON.stringify(Array.from(this.shownCampaigns)))}incrementVisitCount(){let e=parseInt(localStorage.getItem("revenue_boost_visit_count")||"0");localStorage.setItem("revenue_boost_visit_count",(e+1).toString())}getSessionId(){return this.sessionId}getVisitCount(){return parseInt(localStorage.getItem("revenue_boost_visit_count")||"1")}isReturningVisitor(){return this.getVisitCount()>1}wasShown(e){return this.shownCampaigns.has(e)}markShown(e){this.shownCampaigns.add(e),this.saveShownCampaigns()}getData(){return{sessionId:this.sessionId,visitCount:this.getVisitCount(),isReturningVisitor:this.isReturningVisitor(),shownCampaigns:Array.from(this.shownCampaigns)}}clear(){sessionStorage.removeItem(oe),sessionStorage.removeItem(se),this.shownCampaigns.clear(),this.sessionId=this.initSessionId()}},H=new ae;var J=class{constructor(e={}){u(this,"cache",new Map);u(this,"cfg");u(this,"loadingPromises",new Map);this.cfg={timeoutMs:8e3,debug:!1,...e}}log(...e){this.cfg.debug&&console.log("[Revenue Boost Loader]",...e)}async preloadComponents(e){let n=Array.from(new Set(e));await Promise.all(n.map(i=>this.loadComponent(i).catch(o=>{this.log("Preload failed for",i,o?.message||o)})))}async loadComponent(e){let n=e;if(this.cache.has(n))return this.log("Cache hit:",n),this.cache.get(n);if(this.loadingPromises.has(n))return this.log("Already loading:",n),this.loadingPromises.get(n);let i=this._loadComponentInternal(n);this.loadingPromises.set(n,i);try{let o=await i;return this.cache.set(n,o),o}finally{this.loadingPromises.delete(n)}}async _loadComponentInternal(e){let n=this.loadFromGlobal(e);if(n)return this.cache.set(e,n),n;try{let i=await this.loadViaDynamicImport(e);if(i)return this.cache.set(e,i),i}catch(i){this.log("Dynamic import failed for",e,i)}if(this.cfg.baseUrl)try{let i=await this.loadViaScript(e);if(i)return this.cache.set(e,i),i}catch(i){this.log("Script loading failed for",e,i)}throw new Error(`Component for template '${e}' not found`)}loadFromGlobal(e){let i=globalThis.RevenueBoostComponents;return i&&i[e]?(this.log("Loaded from global registry:",e),i[e]):null}async loadViaDynamicImport(e){return null}async loadViaScript(e){let n=this.getBundleName(e),i=`${this.cfg.baseUrl}/${n}?v=${this.cfg.version||"1"}`;return this.log("Loading script:",i),new Promise((o,r)=>{let a=setTimeout(()=>{r(new Error(`Timeout loading ${n}`))},this.cfg.timeoutMs),c=document.createElement("script");c.src=i,c.async=!0,c.onload=()=>{clearTimeout(a);let d=this.loadFromGlobal(e);d?o(d):r(new Error(`Component ${e} not registered after script load`))},c.onerror=()=>{clearTimeout(a),r(new Error(`Failed to load script: ${i}`))},document.head.appendChild(c)})}getBundleName(e){return`${e.toLowerCase().replace(/_/g,"-")}.bundle.js`}};X();we();function It({campaign:t,onClose:e,onShow:n,loader:i}){let[o,r]=L(null),[a,c]=L(!0),[d,l]=L(null);return ve(()=>{let p=!0;async function s(){try{console.log("[PopupManager] Loading component for:",t.templateType);let h=await i.loadComponent(t.templateType);p&&(r(()=>h),c(!1),n?.(t.id))}catch(h){console.error("[PopupManager] Failed to load component:",h),p&&(l(h instanceof Error?h.message:"Failed to load popup"),c(!1))}}return s(),()=>{p=!1}},[t.id,t.templateType]),a?R("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:999999}},"Loading..."):d?(console.error("[PopupManager] Error:",d),null):o?R(o,{config:{...t.contentConfig,...t.designConfig,id:t.id},isVisible:!0,onClose:e,campaignId:t.id,renderInline:!1}):null}function ot(t,e,n,i){let o=document.createElement("div");o.id=`revenue-boost-popup-${t.id}`,document.body.appendChild(o),q(R(It,{campaign:t,onClose:()=>{e(),r()},onShow:i,loader:n}),o);function r(){q(null,o),o.remove()}return r}var ee=class{constructor(e={}){u(this,"config");u(this,"callback",null);u(this,"active",!1);u(this,"triggered",!1);u(this,"startTime",0);u(this,"mouseMoveHandler",null);this.config={sensitivity:e.sensitivity||"medium",delay:e.delay||1e3,mobileEnabled:e.mobileEnabled||!1}}start(e){this.active||this.isMobile()&&!this.config.mobileEnabled||(this.callback=e,this.active=!0,this.triggered=!1,this.startTime=Date.now(),this.mouseMoveHandler=this.handleMouseMove.bind(this),document.addEventListener("mousemove",this.mouseMoveHandler))}stop(){this.active&&(this.active=!1,this.mouseMoveHandler&&(document.removeEventListener("mousemove",this.mouseMoveHandler),this.mouseMoveHandler=null))}isActive(){return this.active}destroy(){this.stop(),this.callback=null}handleMouseMove(e){!this.active||this.triggered||Date.now()-this.startTime<this.config.delay||this.isExitIntent(e)&&this.trigger()}isExitIntent(e){let n=this.getSensitivityThreshold();return e.clientY<=n}getSensitivityThreshold(){switch(this.config.sensitivity){case"low":return 5;case"medium":return 20;case"high":return 50;default:return 20}}trigger(){this.triggered||!this.callback||(this.triggered=!0,this.callback(),this.stop())}isMobile(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}};var te=class{constructor(e={}){u(this,"config");u(this,"callback",null);u(this,"active",!1);u(this,"triggered",!1);u(this,"scrollHandler",null);u(this,"debounceTimer",null);this.config={depthPercentage:e.depthPercentage||50,direction:e.direction||"down",debounceTime:e.debounceTime||100}}start(e){this.active||(this.callback=e,this.active=!0,this.triggered=!1,this.scrollHandler=this.handleScroll.bind(this),window.addEventListener("scroll",this.scrollHandler,{passive:!0}))}stop(){this.active&&(this.active=!1,this.scrollHandler&&(window.removeEventListener("scroll",this.scrollHandler,{passive:!0}),this.scrollHandler=null),this.debounceTimer&&(clearTimeout(this.debounceTimer),this.debounceTimer=null))}isActive(){return this.active}getCurrentScrollDepth(){let e=window.scrollY||window.pageYOffset,n=document.documentElement.scrollHeight,i=window.innerHeight,o=n-i;if(o<=0)return 0;let r=e/o*100;return Math.min(100,Math.max(0,Math.round(r)))}hasReachedDepth(){return this.getCurrentScrollDepth()>=this.config.depthPercentage}destroy(){this.stop(),this.callback=null}handleScroll(e){!this.active||this.triggered||(this.debounceTimer&&clearTimeout(this.debounceTimer),this.debounceTimer=window.setTimeout(()=>{this.checkScrollDepth()},this.config.debounceTime))}checkScrollDepth(){!this.active||this.triggered||this.hasReachedDepth()&&this.trigger()}trigger(){this.triggered||!this.callback||(this.triggered=!0,this.callback(),this.stop())}};var ne=class{constructor(e={}){u(this,"config");u(this,"callback",null);u(this,"active",!1);u(this,"triggered",!1);u(this,"timer",null);u(this,"lastActivityTime",0);u(this,"activityHandler",null);this.config={idleDuration:e.idleDuration||3e4,events:e.events||["mousemove","mousedown","keypress","scroll","touchstart","click"]}}start(e){this.active||(this.callback=e,this.active=!0,this.triggered=!1,this.lastActivityTime=Date.now(),this.activityHandler=this.handleActivity.bind(this),this.config.events.forEach(n=>{document.addEventListener(n,this.activityHandler,{passive:!0})}),this.resetTimer())}stop(){this.active&&(this.active=!1,this.activityHandler&&(this.config.events.forEach(e=>{document.removeEventListener(e,this.activityHandler,{passive:!0})}),this.activityHandler=null),this.timer!==null&&(clearTimeout(this.timer),this.timer=null))}isActive(){return this.active}getIdleTime(){return this.active?Date.now()-this.lastActivityTime:0}destroy(){this.stop(),this.callback=null}handleActivity(e){!this.active||this.triggered||(this.lastActivityTime=Date.now(),this.resetTimer())}resetTimer(){this.timer!==null&&clearTimeout(this.timer),this.timer=window.setTimeout(()=>{this.trigger()},this.config.idleDuration)}trigger(){this.triggered||!this.callback||(this.triggered=!0,this.callback(),this.stop())}};var ie=class{constructor(){u(this,"cleanupFunctions",[]);u(this,"exitIntentDetector",null);u(this,"scrollDepthTracker",null);u(this,"timeDelayHandler",null);u(this,"idleTimer",null);u(this,"cartEventListener",null);u(this,"customEventHandler",null)}async evaluateTriggers(e){let n=e.clientTriggers?.enhancedTriggers;if(!n||Object.keys(n).length===0)return!0;let i=n.logic_operator||"AND",o=[];if(n.page_load!==void 0){let r=await this.checkPageLoad(n.page_load);o.push(r)}if(n.scroll_depth!==void 0){let r=await this.checkScrollDepth(n.scroll_depth);o.push(r)}if(n.exit_intent!==void 0){let r=await this.checkExitIntent(n.exit_intent);o.push(r)}if(n.idle_timer!==void 0){let r=await this.checkIdleTimer(n.idle_timer);o.push(r)}return o.length===0?!0:i==="OR"?o.some(r=>r===!0):o.every(r=>r===!0)}async checkPageLoad(e){if(!e.enabled)return!1;let n=e.delay||0;return n>0&&await this.delay(n),!0}async checkScrollDepth(e){return e.enabled?new Promise(n=>{this.scrollDepthTracker=new te({depthPercentage:e.depth_percentage||50,direction:e.direction||"down"}),this.scrollDepthTracker.start(()=>{n(!0)}),this.scrollDepthTracker.hasReachedDepth()&&(this.scrollDepthTracker.destroy(),n(!0))}):!1}async checkExitIntent(e){return e.enabled?new Promise(n=>{this.exitIntentDetector=new ee({sensitivity:e.sensitivity||"medium",delay:e.delay||1e3}),this.exitIntentDetector.start(()=>{n(!0)})}):!1}async checkIdleTimer(e){return e.enabled?new Promise(n=>{this.idleTimer=new ne({idleDuration:(e.idle_duration||30)*1e3}),this.idleTimer.start(()=>{n(!0)})}):!1}delay(e){return new Promise(n=>{let i=setTimeout(n,e);this.cleanupFunctions.push(()=>clearTimeout(i))})}cleanup(){this.cleanupFunctions.forEach(e=>e()),this.cleanupFunctions=[],this.exitIntentDetector&&(this.exitIntentDetector.destroy(),this.exitIntentDetector=null),this.scrollDepthTracker&&(this.scrollDepthTracker.destroy(),this.scrollDepthTracker=null),this.timeDelayHandler&&(this.timeDelayHandler.destroy(),this.timeDelayHandler=null),this.idleTimer&&(this.idleTimer.destroy(),this.idleTimer=null),this.cartEventListener&&(this.cartEventListener.destroy(),this.cartEventListener=null),this.customEventHandler&&(this.customEventHandler.destroy(),this.customEventHandler=null)}};if(typeof window<"u"){let t=(X(),Pe(ze)),e=(we(),Pe(rt));window.RevenueBoostPreact={h:t.h,render:t.render,Component:t.Component,Fragment:t.Fragment,hooks:{useState:e.useState,useEffect:e.useEffect,useCallback:e.useCallback,useRef:e.useRef,useMemo:e.useMemo}},console.log("[Revenue Boost] \u269B\uFE0F Preact runtime exposed globally")}function Dt(){let t=window.REVENUE_BOOST_CONFIG||{};return{apiUrl:t.apiUrl||"",shopDomain:t.shopDomain||"",debug:t.debug||!1,previewMode:t.previewMode||!1,previewId:t.previewId,sessionId:t.sessionId,visitCount:t.visitCount,isReturningVisitor:t.isReturningVisitor,deviceType:t.deviceType}}function xt(){return new Promise(t=>{document.readyState==="complete"||document.readyState==="interactive"?t():document.addEventListener("DOMContentLoaded",()=>t())})}var Ce=class{constructor(){u(this,"config",Dt());u(this,"api",new Y(this.config));u(this,"loader",new J({debug:this.config.debug,baseUrl:this.config.apiUrl?`${this.config.apiUrl}/bundles`:"/apps/revenue-boost/bundles",version:"1"}));u(this,"triggerManager",new ie);u(this,"initialized",!1);u(this,"cleanupFn",null)}log(...e){this.config.debug&&console.log("[Revenue Boost]",...e)}async init(){if(this.initialized){this.log("Already initialized");return}console.log("[Revenue Boost] \u{1F680} Starting initialization..."),console.log("[Revenue Boost] \u{1F4CB} Config:",this.config),console.log("[Revenue Boost] \u{1F511} Session ID:",H.getSessionId()),await xt(),this.log("DOM ready");try{let e=await this.api.fetchActiveCampaigns(H.getSessionId()),{campaigns:n}=e;if(this.log(`Campaigns received: ${n?.length||0}`),!n||n.length===0){this.log("No active campaigns");return}this.setupCampaigns(n),this.initialized=!0,console.log("[Revenue Boost] \u2705 Initialization complete!")}catch(e){console.error("[Revenue Boost] \u274C Error fetching campaigns:",e)}}setupCampaigns(e){let i=e.sort((r,a)=>(a.priority||0)-(r.priority||0)).filter(r=>this.config.previewMode&&this.config.previewId===r.id?!0:H.wasShown(r.id)?(this.log(`Campaign already shown: ${r.id}`),!1):!0);if(i.length===0){this.log("No campaigns to display");return}let o=i[0];this.log("Showing campaign:",o.name),this.config.previewMode&&this.config.previewId===o.id?setTimeout(()=>this.showCampaign(o),0):this.showCampaign(o)}async showCampaign(e){if(this.config.previewMode&&this.config.previewId===e.id){this.renderCampaign(e);return}this.log("Evaluating triggers for campaign:",e.name);try{await this.triggerManager.evaluateTriggers(e)?(this.log("Triggers passed, showing campaign"),this.renderCampaign(e)):this.log("Triggers not met, campaign not shown")}catch(i){console.error("[Revenue Boost] Error evaluating triggers:",i),this.renderCampaign(e)}}async renderCampaign(e){this.config.previewMode&&this.config.previewId===e.id||(H.markShown(e.id),await this.api.recordFrequency(H.getSessionId(),e.id)),this.cleanupFn=ot(e,()=>{this.log("Popup closed"),this.cleanupFn=null,this.triggerManager.cleanup()},this.loader,i=>{this.log("Popup shown:",i)})}},Ht=new Ce;Ht.init().catch(t=>{console.error("[Revenue Boost] Initialization failed:",t)});})();
